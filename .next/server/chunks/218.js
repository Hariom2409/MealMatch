"use strict";exports.id=218,exports.ids=[218],exports.modules={157:(e,t,o)=>{o.d(t,{Z:()=>n});var r=o(9003),a=o.n(r),s=o(6689),l=o(4728),i=o(997);let d=s.forwardRef(({bsPrefix:e,bg:t="primary",pill:o=!1,text:r,className:s,as:d="span",...n},c)=>{let u=(0,l.vE)(e,"badge");return(0,i.jsx)(d,{ref:c,...n,className:a()(s,u,o&&"rounded-pill",r&&`text-${r}`,t&&`bg-${t}`)})});d.displayName="Badge";let n=d},6374:(e,t,o)=>{o.d(t,{Z:()=>V});var r=o(9003),a=o.n(r),s=o(5918),l=o.n(s),i=o(7107),d=o.n(i),n=o(2902),c=o.n(n),u=o(8951),g=o.n(u),p=o(7233),f=o.n(p),m=o(6449),y=o.n(m),h=o(5205),w=o.n(h),b=o(3282),v=o.n(b),D=o(6816),T=o.n(D),N=o(6479),x=o.n(N),E=o(6689),I=o(7528),A=o.n(I),R=o(3835),$=o(6944),F=o(4728),B=o(997);let j=E.forwardRef(({className:e,bsPrefix:t,as:o="div",...r},s)=>(t=(0,F.vE)(t,"modal-body"),(0,B.jsx)(o,{ref:s,className:a()(e,t),...r})));j.displayName="ModalBody";var k=o(2216);let C=E.forwardRef(({bsPrefix:e,className:t,contentClassName:o,centered:r,size:s,fullscreen:l,children:i,scrollable:d,...n},c)=>{e=(0,F.vE)(e,"modal");let u=`${e}-dialog`,g="string"==typeof l?`${e}-fullscreen-${l}`:`${e}-fullscreen`;return(0,B.jsx)("div",{...n,ref:c,className:a()(u,t,s&&`${e}-${s}`,r&&`${u}-centered`,d&&`${u}-scrollable`,l&&g),children:(0,B.jsx)("div",{className:a()(`${e}-content`,o),children:i})})});C.displayName="ModalDialog";let P=C,S=E.forwardRef(({className:e,bsPrefix:t,as:o="div",...r},s)=>(t=(0,F.vE)(t,"modal-footer"),(0,B.jsx)(o,{ref:s,className:a()(e,t),...r})));S.displayName="ModalFooter";var M=o(8889);let O=E.forwardRef(({bsPrefix:e,className:t,closeLabel:o="Close",closeButton:r=!1,...s},l)=>(e=(0,F.vE)(e,"modal-header"),(0,B.jsx)(M.Z,{ref:l,...s,className:a()(t,e),closeLabel:o,closeButton:r})));O.displayName="ModalHeader";let U=(0,o(8236).Z)("h4"),z=E.forwardRef(({className:e,bsPrefix:t,as:o=U,...r},s)=>(t=(0,F.vE)(t,"modal-title"),(0,B.jsx)(o,{ref:s,className:a()(e,t),...r})));function Z(e){return(0,B.jsx)($.Z,{...e,timeout:null})}function q(e){return(0,B.jsx)($.Z,{...e,timeout:null})}z.displayName="ModalTitle";let H=E.forwardRef(({bsPrefix:e,className:t,style:o,dialogClassName:r,contentClassName:s,children:i,dialogAs:n=P,"data-bs-theme":u,"aria-labelledby":p,"aria-describedby":m,"aria-label":h,show:b=!1,animation:D=!0,backdrop:N=!0,keyboard:I=!0,onEscapeKeyDown:$,onShow:j,onHide:C,container:S,autoFocus:M=!0,enforceFocus:O=!0,restoreFocus:U=!0,restoreFocusOptions:z,onEntered:H,onExit:V,onExiting:G,onEnter:L,onEntering:_,onExited:K,backdropClassName:J,manager:W,...Q},X)=>{let[Y,ee]=(0,E.useState)({}),[et,eo]=(0,E.useState)(!1),er=(0,E.useRef)(!1),ea=(0,E.useRef)(!1),es=(0,E.useRef)(null),[el,ei]=y()(),ed=v()(X,ei),en=w()(C),ec=(0,F.SC)();e=(0,F.vE)(e,"modal");let eu=(0,E.useMemo)(()=>({onHide:en}),[en]);function eg(){return W||(0,R.t)({isRTL:ec})}function ep(e){if(!d())return;let t=eg().getScrollbarWidth()>0,o=e.scrollHeight>c()(e).documentElement.clientHeight;ee({paddingRight:t&&!o?f()():void 0,paddingLeft:!t&&o?f()():void 0})}let ef=w()(()=>{el&&ep(el.dialog)});T()(()=>{g()(window,"resize",ef),null==es.current||es.current()});let em=()=>{er.current=!0},ey=e=>{er.current&&el&&e.target===el.dialog&&(ea.current=!0),er.current=!1},eh=()=>{eo(!0),es.current=x()(el.dialog,()=>{eo(!1)})},ew=e=>{e.target===e.currentTarget&&eh()},eb=e=>{if("static"===N){ew(e);return}if(ea.current||e.target!==e.currentTarget){ea.current=!1;return}null==C||C()},ev=(0,E.useCallback)(t=>(0,B.jsx)("div",{...t,className:a()(`${e}-backdrop`,J,!D&&"show")}),[D,J,e]),eD={...o,...Y};return eD.display="block",(0,B.jsx)(k.Z.Provider,{value:eu,children:(0,B.jsx)(A(),{show:b,ref:ed,backdrop:N,container:S,keyboard:!0,autoFocus:M,enforceFocus:O,restoreFocus:U,restoreFocusOptions:z,onEscapeKeyDown:e=>{I?null==$||$(e):(e.preventDefault(),"static"===N&&eh())},onShow:j,onHide:C,onEnter:(e,t)=>{e&&ep(e),null==L||L(e,t)},onEntering:(e,t)=>{null==_||_(e,t),l()(window,"resize",ef)},onEntered:H,onExit:e=>{null==es.current||es.current(),null==V||V(e)},onExiting:G,onExited:e=>{e&&(e.style.display=""),null==K||K(e),g()(window,"resize",ef)},manager:eg(),transition:D?Z:void 0,backdropTransition:D?q:void 0,renderBackdrop:ev,renderDialog:o=>(0,B.jsx)("div",{role:"dialog",...o,style:eD,className:a()(t,e,et&&`${e}-static`,!D&&"show"),onClick:N?eb:void 0,onMouseUp:ey,"data-bs-theme":u,"aria-label":h,"aria-labelledby":p,"aria-describedby":m,children:(0,B.jsx)(n,{...Q,onMouseDown:em,className:r,contentClassName:s,children:i})})})})});H.displayName="Modal";let V=Object.assign(H,{Body:j,Header:O,Title:z,Footer:S,Dialog:P,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150})},5562:(e,t,o)=>{o.a(e,async(e,r)=>{try{o.d(t,{E4:()=>n,d4:()=>d,hj:()=>c,oS:()=>u});var a=o(1492),s=o(3392),l=o(5375),i=e([a,s,l]);[a,s,l]=i.then?(await i)():i;let d=async(e,t)=>{console.log("Creating food post with data:",e),console.log("Posted by user ID:",e.postedBy);try{let o="";if(t){console.log("Uploading image to Firebase Storage");let e=Date.now(),r=Math.random().toString(36).substring(2,10),a=`${e}-${r}-${t.name}`,i=(0,s.ref)(l.tO,`food-images/${a}`),d=new Promise(async(e,o)=>{try{if(t.size>5242880)throw Error("Image file is too large. Maximum size is 5MB.");let o={contentType:t.type,cacheControl:"public,max-age=86400"},r=await (0,s.uploadBytes)(i,t,o);console.log("Image uploaded successfully");let a=await (0,s.getDownloadURL)(r.ref);e(a)}catch(e){console.error("Error in image upload process:",e),o(e)}}),n=new Promise((e,t)=>{setTimeout(()=>{t(Error("Image upload timed out. Please try again with a smaller image."))},6e4)});try{o=await Promise.race([d,n]),console.log("Image uploaded, URL:",o)}catch(e){throw console.error("Image upload failed:",e),e}}let r={...e,imageUrl:o,status:"available",createdAt:(0,a.serverTimestamp)(),preparedTime:a.Timestamp.fromDate(e.preparedTime),expiryTime:a.Timestamp.fromDate(e.expiryTime)};console.log("Adding food post to Firestore with final data:",r);let i=await (0,a.addDoc)((0,a.collection)(l.db,"foodPosts"),r);return console.log("Adding safety checklist to Firestore"),await (0,a.addDoc)((0,a.collection)(l.db,"safetyChecklists"),{...e.checklist,foodId:i.id,createdAt:(0,a.serverTimestamp)()}),console.log("Food post created successfully with ID:",i.id),i.id}catch(e){throw console.error("Error creating food post:",e),e}},n=async e=>{try{console.log("Getting food posts from Firestore with filters:",e);let t=(0,a.collection)(l.db,"foodPosts"),o=[];e?.status&&(o.push((0,a.where)("status","==",e.status)),console.log("Added status filter:",e.status)),e?.foodType==="vegetarian"?(o.push((0,a.where)("isVegetarian","==",!0)),console.log("Added vegetarian filter")):e?.foodType==="non-vegetarian"?(o.push((0,a.where)("isNonVegetarian","==",!0)),console.log("Added non-vegetarian filter")):e?.foodType==="gluten-free"&&(o.push((0,a.where)("isGlutenFree","==",!0)),console.log("Added gluten-free filter")),e?.userId&&(console.log("Adding postedBy filter with user ID:",e.userId),o.push((0,a.where)("postedBy","==",e.userId))),o.push((0,a.orderBy)("createdAt","desc")),console.log("Added orderBy createdAt desc"),console.log("Final query constraints:",JSON.stringify(o));let r=await (0,a.getDocs)((0,a.query)(t,...o));console.log(`Found ${r.size} food posts in Firestore`),0===r.size&&console.log("No posts found. Collection might be empty or filters too restrictive");let s=[];for(let t of r.docs){let o=t.data(),r=(0,a.query)((0,a.collection)(l.db,"safetyChecklists"),(0,a.where)("foodId","==",t.id),(0,a.limit)(1)),i=await (0,a.getDocs)(r),d=null;if(!i.empty){let e=i.docs[0].data();d={id:i.docs[0].id,foodId:t.id,hygieneRating:e.hygieneRating,properStorage:e.properStorage,safeTemperature:e.safeTemperature,handlingProcedures:e.handlingProcedures,notes:e.notes}}let n={id:t.id,title:o.title,quantity:o.quantity,description:o.description,imageUrl:o.imageUrl,preparedTime:o.preparedTime.toDate(),expiryTime:o.expiryTime.toDate(),location:o.location,isVegetarian:o.isVegetarian,isNonVegetarian:o.isNonVegetarian,isGlutenFree:o.isGlutenFree,postedBy:o.postedBy,postedByName:o.postedByName,status:o.status,createdAt:o.createdAt?o.createdAt.toDate():new Date,checklist:d};if(e?.nearExpiry){let e=new Date,t=n.expiryTime,o=new Date(e.getTime()+108e5);t<o&&t>e&&s.push(n)}else s.push(n)}return s}catch(e){throw console.error("Error fetching food posts:",e),e}},c=async e=>{try{console.log("Deleting food post with ID:",e),await (0,a.deleteDoc)((0,a.doc)(l.db,"foodPosts",e));let t=(0,a.query)((0,a.collection)(l.db,"safetyChecklists"),(0,a.where)("foodId","==",e),(0,a.limit)(1)),o=await (0,a.getDocs)(t);o.empty||await (0,a.deleteDoc)((0,a.doc)(l.db,"safetyChecklists",o.docs[0].id)),console.log("Food post and related documents deleted successfully")}catch(e){throw console.error("Error deleting food post:",e),e}},u=async(e,t)=>{try{console.log(`Updating food post ${e} status to: ${t}`);let o=(0,a.doc)(l.db,"foodPosts",e);await (0,a.updateDoc)(o,{status:t}),console.log("Food post status updated successfully")}catch(e){throw console.error("Error updating food post status:",e),e}};r()}catch(e){r(e)}})}};