(()=>{var e={};e.id=888,e.ids=[888],e.modules={8111:(e,r,t)=>{"use strict";t.a(e,async(e,o)=>{try{t.d(r,{H:()=>g,a:()=>u});var i=t(997),a=t(6689),s=t(401),l=t(1492),n=t(5375),c=e([s,l,n]);[s,l,n]=c.then?(await c)():c;let d=(0,a.createContext)(void 0),u=()=>{let e=(0,a.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},g=({children:e})=>{let[r,t]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0),u=async()=>{if(n.I8.currentUser){await n.I8.currentUser.reload();let e=n.I8.currentUser;if(e)try{let r=await (0,l.getDoc)((0,l.doc)(n.db,"users",e.uid));if(r.exists()){let o=r.data();t({...o,id:e.uid,email:e.email||o.email,name:e.displayName||o.name,emailVerified:e.emailVerified})}}catch(e){console.error("Error refreshing user state:",e)}}};(0,a.useEffect)(()=>(console.log("AuthProvider: Initializing auth state listener"),(0,s.onAuthStateChanged)(n.I8,async e=>{if(e){console.log("Auth state changed: User is logged in:",e.email);try{let r=await (0,l.getDoc)((0,l.doc)(n.db,"users",e.uid));if(r.exists()){let o=r.data();t({...o,id:e.uid,email:e.email||o.email,name:e.displayName||o.name,emailVerified:e.emailVerified})}else console.log("No user document found in Firestore, creating basic user object"),t({id:e.uid,email:e.email||"",name:e.displayName||"",role:"donor",createdAt:new Date,emailVerified:e.emailVerified})}catch(r){console.error("Error fetching user data from Firestore:",r),t({id:e.uid,email:e.email||"",name:e.displayName||"",role:"donor",createdAt:new Date,emailVerified:e.emailVerified})}}else console.log("Auth state changed: No user is logged in"),t(null);c(!1)})),[]);let g=async(e,r,o)=>{c(!0),console.log("Registering new user:",e,o);try{console.log("Creating user in Firebase Auth...");let i=(await (0,s.createUserWithEmailAndPassword)(n.I8,e,r)).user;console.log("User created in Firebase Auth:",i.uid),console.log("Sending verification email..."),await (0,n.zk)(i),o.name&&(console.log("Setting display name:",o.name),await (0,s.updateProfile)(i,{displayName:o.name}));let a={id:i.uid,name:o.name||"",email:e,role:o.role||"donor",phone:o.phone||"",address:o.address||"",profileImage:o.profileImage||"",organizationName:o.organizationName||"",organizationDetails:o.organizationDetails||"",createdAt:new Date,emailVerified:i.emailVerified};console.log("Saving user document to Firestore");try{await (0,l.setDoc)((0,l.doc)(n.db,"users",i.uid),a),console.log("User document saved to Firestore")}catch(e){console.error("Error saving user to Firestore:",e)}t(a),console.log("User registration complete")}catch(e){throw console.error("Error during registration:",e),e.code&&console.error("Firebase error code:",e.code),e}finally{c(!1)}},m=async(e,r)=>{c(!0),console.log("Attempting login for:",e);try{await (0,s.signInWithEmailAndPassword)(n.I8,e,r),console.log("Login successful")}catch(e){throw console.error("Login error:",e),e}finally{c(!1)}},p=async()=>{c(!0),console.log("Attempting Google login");try{let e=new s.GoogleAuthProvider,r=(await (0,s.signInWithPopup)(n.I8,e)).user;if(!(await (0,l.getDoc)((0,l.doc)(n.db,"users",r.uid))).exists()){console.log("Creating new user document for Google user");let e={id:r.uid,name:r.displayName||"",email:r.email||"",role:"donor",profileImage:r.photoURL||"",createdAt:new Date,emailVerified:r.emailVerified};await (0,l.setDoc)((0,l.doc)(n.db,"users",r.uid),e)}console.log("Google login successful")}catch(e){throw console.error("Google login error:",e),e}finally{c(!1)}},h=async()=>{c(!0),console.log("Logging out user");try{await (0,s.signOut)(n.I8),t(null),console.log("Logout successful")}catch(e){throw console.error("Logout error:",e),e}finally{c(!1)}},f=async e=>{if(!r){console.error("Cannot update user data: No user is logged in");return}c(!0),console.log("Updating user data for:",r.id);try{let o=(0,l.doc)(n.db,"users",r.id);await (0,l.setDoc)(o,{...e},{merge:!0}),t(r=>r?{...r,...e}:null),e.name&&n.I8.currentUser&&await (0,s.updateProfile)(n.I8.currentUser,{displayName:e.name}),console.log("User data updated successfully")}catch(e){throw console.error("Error updating user data:",e),e}finally{c(!1)}},w=async e=>{c(!0),console.log("Sending password reset email to:",e);try{await (0,s.sendPasswordResetEmail)(n.I8,e),console.log("Password reset email sent")}catch(e){throw console.error("Error sending password reset email:",e),e}finally{c(!1)}},y=async()=>{if(!n.I8.currentUser)throw Error("No user is logged in");try{await (0,n.zk)(n.I8.currentUser),console.log("Verification email sent")}catch(e){throw console.error("Error sending verification email:",e),e}};return i.jsx(d.Provider,{value:{user:r,currentUser:r,loading:o,register:g,login:m,loginWithGoogle:p,logout:h,updateUserData:f,resetPassword:w,sendVerificationEmail:y,isEmailVerified:()=>n.I8.currentUser?.emailVerified||!1,refreshUserState:u},children:!o&&e})};o()}catch(e){o(e)}})},7719:(e,r,t)=>{"use strict";t.d(r,{F:()=>c,f:()=>d});var o=t(997);let{createContext:i,useContext:a,useState:s,useEffect:l}=t(6689),n=i(void 0),c=()=>{let e=a(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e},d=({children:e})=>{let[r,t]=s("light");return l(()=>{},[]),o.jsx(n.Provider,{value:{theme:r,toggleTheme:()=>{let e="light"===r?"dark":"light";t(e),document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e)}},children:e})}},3893:(e,r,t)=>{"use strict";t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{default:()=>d});var i=t(997);t(6689);var a=t(6201),s=t(1163);t(4032),t(108);var l=t(8111),n=t(7719),c=e([a,l]);function d({Component:e,pageProps:r}){return(0,s.useRouter)(),i.jsx(l.H,{children:(0,i.jsxs)(n.f,{children:[i.jsx(e,{...r}),i.jsx(a.Toaster,{position:"bottom-center",toastOptions:{duration:3e3,style:{background:"var(--card-bg)",color:"var(--text-primary)"}}})]})})}[a,l]=c.then?(await c)():c,o()}catch(e){o(e)}})},5375:(e,r,t)=>{"use strict";t.a(e,async(e,o)=>{try{let d;t.d(r,{I8:()=>u,db:()=>p,tO:()=>h,zk:()=>m});var i=t(3745),a=t(401),s=t(1492),l=t(3392),n=t(9500),c=e([i,a,s,l,n]);[i,a,s,l,n]=c.then?(await c)():c,console.log("Initializing Firebase with config"),d=(0,i.getApps)().length?(0,i.getApps)()[0]:(0,i.initializeApp)({apiKey:"AIzaSyD5HR7kfWqKyWe_s_t47q0197wTlZArymg",authDomain:"mealmatch-ee54c.firebaseapp.com",projectId:"mealmatch-ee54c",storageBucket:"mealmatch-ee54c.firebasestorage.app",messagingSenderId:"824081632987",appId:"1:824081632987:web:1d6ae6fec63a7f96cb06fe",measurementId:"G-L54R5QQ9MJ"});let u=(0,a.getAuth)(d),g={url:`${process.env.NEXT_PUBLIC_APP_URL||"http://localhost:3000"}/login`,handleCodeInApp:!1},m=e=>(0,a.sendEmailVerification)(e,g),p=(0,s.getFirestore)(d),h=(0,l.getStorage)(d);o()}catch(e){o(e)}})},108:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")},9500:e=>{"use strict";e.exports=import("firebase/analytics")},3745:e=>{"use strict";e.exports=import("firebase/app")},401:e=>{"use strict";e.exports=import("firebase/auth")},1492:e=>{"use strict";e.exports=import("firebase/firestore")},3392:e=>{"use strict";e.exports=import("firebase/storage")},6201:e=>{"use strict";e.exports=import("react-hot-toast")}};var r=require("../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[567,552],()=>t(3893));module.exports=o})();